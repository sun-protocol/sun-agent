[build-system]
requires = ["hatchling"]
build-backend = "hatchling.build"

[project]
name = "sunagent-app"
version = "0.0.27b8"
license = { file = "LICENSE-CODE" }
description = "sunagent app"
readme = "README.md"
requires-python = ">=3.12"
classifiers = [
    "Programming Language :: Python :: 3",
    "License :: OSI Approved :: MIT License",
    "Operating System :: OS Independent",
]

# 仅保留最常用 / 启动必需的依赖
dependencies = [
    "autogen-core",
    "autogen-ext",
    "autogen-agentchat",
    "autogen",
    "flask[async]",
    "flask_cors",
    "openpyxl",            # Excel 读写
    "prometheus_client",   # 监控
    "beem",                # Hive 链交互
    "oauthlib",            # OAuth
    "tweepy",
    "quart",
    "aiohttp",
    "async_lru",
    "google-genai",
    "apscheduler",
    "pytz",
    "sunagent-ext>=0.0.6b10",
]

# 可选依赖
[project.optional-dependencies]
storm = [
    "knowledge_storm==1.0.1",
    "torch>=2.0.0,<2.3.0",
    "tavily-python",
]
# 一键安装所有可选依赖
all = [
    "sunagent-app[storm]",
]

[dependency-groups]
dev = [
    "types-pytz",
    "types-requests",
]

[tool.hatch.version]
path = "src/sunagent_app/version.py"

[project.scripts]
sunagent_app = "sunagent_app.app:main"

[tool.ruff]
extend = "../../pyproject.toml"
include = ["src/**", "tests/*.py"]

[tool.pyright]
extends = "../../pyproject.toml"
include = ["tests"]

[tool.mypy.overrides]
tweepy = { ignore_errors = true }

[tool.pytest.ini_options]
minversion = "6.0"
testpaths = ["tests"]

[tool.poe]
include = "../../shared_tasks.toml"

[tool.poe.tasks]
test = "pytest -n auto"